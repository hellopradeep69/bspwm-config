#!/bin/bash

# Minimum terminal size
min_rows=20
min_cols=60

# Hide cursor
tput civis
trap "tput cnorm; clear; exit" INT

while true; do
    clear

    # Get terminal size
    rows=$(tput lines)
    cols=$(tput cols)

    if (( rows < min_rows || cols < min_cols )); then
        echo "Terminal not big enough. Resize to at least ${min_cols}x${min_rows}."
        sleep 2
        continue
    fi

    tty-clock -c -C 7 -s -n &
    tty_pid=$!

    sleep 0.2

    while kill -0 "$tty_pid" 2>/dev/null; do
        battery_percent=$(acpi -b | grep -oP '\d+%')
        battery_line="Battery: $battery_percent"

        battery_row=$((rows / 2 + 4))
        battery_col=$(( (cols - ${#battery_line}) / 2 ))

        tput cup "$battery_row" "$battery_col"
        printf "\033[1;37m%s\033[0m" "$battery_line"

        sleep 1
    done
done
