#!/bin/bash

# Hide cursor
tput civis
trap "tput cnorm; clear; exit" INT

while true; do
    clear

    # Get terminal size
    rows=$(tput lines)
    cols=$(tput cols)

    # Launch tty-clock centered, white, in background
    tty-clock -c -C 7 -s -n &
    tty_pid=$!

    sleep 0.2  # Let tty-clock draw before printing battery

    while kill -0 "$tty_pid" 2>/dev/null; do
        # Get battery info
        battery_percent=$(acpi -b | grep -oP '\d+%')
        battery_line="Battery: $battery_percent"

        # Compute centered position
        battery_row=$((rows / 2 + 4))
        battery_col=$(( (cols - ${#battery_line}) / 2 ))

        # Move cursor and print battery
        tput cup "$battery_row" "$battery_col"
        printf "\033[1;37m%s\033[0m" "$battery_line"

        sleep 1
    done
done
